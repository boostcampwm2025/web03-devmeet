name: dev -> main 라인

# main 브런치는 오직 dev 브런치에서만 접근이 가능하다.
on:
  pull_request:
    branches:
      - main

jobs:
  check-branch:
    runs-on: ubuntu-22.04
    steps:
      - name: develop에서 온 pr인지 확인하는 로직
        # base_ref는 대상이 되는 branch이고 head_ref은 merge가 되야 하는 branch 이다.
        run: |
          echo "Base: ${{ github.base_ref }}"
          echo "Head: ${{ github.head_ref }}"
          HEAD="${{ github.head_ref }}"

          # dev에서 오는 pr 허용
          if [ "$HEAD" = "dev" ]; then
            echo "✅ dev PR 허용"
            exit 0
          fi

          # gitops로 오는 pr 허용
          if [[ "$HEAD" == gitops/* ]]; then
            echo "✅ gitops PR 허용"
            exit 0
          fi

          echo "❌ dev 또는 gitops/* 에서 온 PR만 main으로 허용됩니다."
          exit 1
  